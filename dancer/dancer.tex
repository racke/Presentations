\usepackage[T1]{fontenc}
\usepackage{mathptmx}
\usepackage[scaled=.90]{helvet}
\usepackage{courier}

\usepackage{beamerthemesplit}
\usepackage{verbatim}
\usepackage{hyperref}
\usepackage{listings}
\lstset{language=Perl,basicstyle=\footnotesize,tabsize=3,showstringspaces=false}

\title{Tanz!}
\author[racke]{Stefan Hornburg (Racke)\\ \texttt{racke@linuxia.de}}
\date[GPW2011]{13. Deutscher Perl-Workshop, Frankfurt, 21. Oktober 2011}


\begin{document}
\maketitle{}

\begin{frame}
  \titlepage
\end{frame}

\tableofcontents

\section{Routes, Filters and Hooks}
\subsection{Routes}

\begin{frame}{Routes}
\begin{itemize}
\item Splat
\item Megasplat
\item Regex
\item Regex mit captures
\end{itemize}
\end{frame}

\subsubsection{Splat}

\subsubsection{Megasplat}

\begin{frame}[fragile]{Megasplat}
\begin{lstlisting}
get '/lostpwd/**' => sub {
    my ($email, $hash) = splat;

    form->fill(email => $email,
               hash => $hash);
    
    template('lostpwd_confirm', form => $form);
}
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Captures}
\begin{lstlisting}
any qr{^/~(?<user>[^/]+)/(?<file>.*?)/?$} => sub {
    my ($capts, $user, $file);

    $capts = captures;
    $file = $capts->{file};
    $user = $capts->{user};

    ...
};
\end{lstlisting}
\end{frame}

\subsection{Filters}
\begin{frame}[fragile]{Filters}
\begin{lstlisting}
before sub {
};

after sub {
};
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{before}
\begin{lstlisting}
before sub {
    unless (session('user')
        || request->path eq '/login'
        || request->path =~ m%^/lostpwd%
        ) {
        redirect '/login';
    }
};
\end{lstlisting}
\end{frame}

\subsection{Hooks}
\begin{frame}{Hooks}
\end{frame}

Die folgenden Hooks existieren in Dancer:

\begin{itemize}
\item before\_deserializer
\item before\_file\_render
\item before\_error\_init
\item before\_error\_render
\item before\_template\_render
\item before\_layout\_render
\item before\_serializer
\item after\_deserializer
\item after\_file\_render
\item after\_template\_render
\item after\_layout\_render
\item after\_error\_render
\end{itemize}

\section{Exceptions}
Exceptions in Dancer sind nicht objektorientiert, um sie
leichtgewichtig und schnell zu halten.
\begin{frame}{Exceptions}
\end{frame}

\section{Plugins}
\begin{frame}{Plugins}
\end{frame}

\subsection{Writing Plugins}
\begin{frame}{Writing Plugins}
\begin{itemize}
\item register
\item register\_plugin
\item plugin\_setting
\end{itemize}
\end{frame}

\subsection{Plugins und Hooks}
\begin{frame}[fragile]{Plugins und Hooks}
\begin{lstlisting}
Dancer::Factory::Hook
        ->instance
        ->install_hooks('before_cart_add');
\end{lstlisting}
\end{frame}

\section{Scripts}
\begin{frame}[fragile]{Scripts}
\begin{lstlisting}
use Dancer ':script';

set logger => 'console';
set logger_format => '%m';
\end{lstlisting}
\end{frame}

\section{Deployment}
\begin{frame}{Deployment}
\end{frame}

\subsection{Perlbal}
\begin{frame}{Perlbal}
\end{frame}

\subsection{Starman}
\begin{frame}{Starman}
\end{frame}

\section{Dancer 2}
\begin{frame}{Dancer2}

\begin{itemize} 
\item keine globalen Variablen
\item 100\% OO Backend (Moo)
\item Scoping for Sub-Applikationen
\item überarbeitete Architektur
\end{itemize}

\end{frame}

\end{document}
